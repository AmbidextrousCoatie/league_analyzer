{% extends "base.html" %}

{% block content %}
    {% include "components/tables.html" %}
    {% include "components/charts.html" %}

<div class="container-fluid">

    <!-- Filter Controls -->
    <div class="card">
        <div class="card-header">
            <h4 data-i18n="league_statistics">League Statistics</h4>
        </div>
        <div class="card-body">
            <!-- Selection Area -->
            <div class="row">
                <div class="col-md-4">
                    <h5 data-i18n="league">League</h5>
                    <div id="buttonsLeague" class="btn-group-horizontal w-100">
                        <!-- Leagues will be inserted here -->
                    </div>
                </div>
                <div class="col-md-4">
                    <h5 data-i18n="season">Season</h5>
                    <div id="buttonsSeason" class="btn-group-horizontal w-100">
                        <!-- Seasons will be inserted here -->
                    </div>
                </div>
                <div class="col-md-4">
                    <h5 data-i18n="week">Week</h5>
                    <div id="buttonsWeek" class="btn-group-horizontal w-100">
                        <!-- Weeks will be inserted here -->
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <h5 data-i18n="team">Team</h5>
                    <div id="buttonsTeam" class="btn-group-horizontal w-100">
                        <!-- Teams will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Season League Standings Block (Season only) -->
    <div id="seasonLeagueStandingsContainer">
        <!-- Season league standings content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.season_league_standings">Initializing season league standings...</p>
        </div>
    </div>

    <!-- League Aggregation Block (League only) -->
    <div id="leagueAggregationContainer">
        <!-- League aggregation content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.league_aggregation">Initializing league aggregation...</p>
        </div>
    </div>

    <!-- League Season Overview Block (League + Season) -->
    <div id="leagueSeasonOverviewContainer">
        <!-- League season overview content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.league_season_overview">Initializing season overview...</p>
        </div>
    </div>

    <!-- Season Overview Block (League + Season + Week/Team) -->
    <div id="seasonOverviewContainer">
        <!-- Season overview content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.season_overview">Initializing detailed overview...</p>
        </div>
    </div>

    <!-- Match Day Block -->
    <div id="matchdayContainer">
        <!-- Match day content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.matchday">Initializing match day content...</p>
        </div>
    </div>

    <!-- Team Details Block -->
    <div id="teamDetailsContainer">
        <!-- Team details content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.team_details">Initializing team details...</p>
        </div>
    </div>

    <!-- Team Performance Analysis Block (League + Season + Team) -->
    <div id="team-performance">
        <!-- Team performance analysis content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.team_performance">Initializing team performance analysis...</p>
        </div>
    </div>

    <!-- Team Win Percentage Analysis Block (League + Season + Team) -->
    <div id="team-win-percentage">
        <!-- Team win percentage analysis content will be rendered here -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden" data-i18n="status.loading">Loading...</span>
            </div>
            <p class="text-muted mt-2" data-i18n="status.initializing.team_win_percentage">Initializing team win percentage analysis...</p>
        </div>
    </div>

</div>

{% endblock %}

{% block scripts %}
<!-- Core dependencies -->
<script src="{{ static_url('js/core/url-state-manager.js') }}"></script>
<script src="{{ static_url('js/core/centralized-button-manager.js') }}"></script>
<script src="{{ static_url('js/content-blocks/base-content-block.js') }}"></script>

<!-- Content blocks -->
<script src="{{ static_url('js/content-blocks/season-league-standings-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/league-aggregation-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/league-season-overview-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/season-overview-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/matchday-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/team-details-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/team-performance-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/team-win-percentage-block.js') }}"></script>
<script src="{{ static_url('js/content-blocks/team-vs-team-comparison-block.js') }}"></script>

<!-- Main application -->
<script src="{{ static_url('js/league-stats-app.js') }}"></script>

<!-- Initialize i18n translations if available -->
{% if translations %}
<script>
    window.translations = {{ translations|tojson }};
</script>
{% endif %}

<!-- Legacy compatibility for external integrations -->
<script>
// Backward compatibility functions for external tools that might call these
window.updateAllContent = function() {
    if (window.leagueStatsApp) {
        window.leagueStatsApp.renderContent();
    }
};

window.handleSelectionChange = function() {
    if (window.leagueStatsApp) {
        window.leagueStatsApp.renderContent();
    }
};

// Make chart refresh function available globally
window.refreshAllCharts = function() {
    if (window.leagueStatsApp) {
        window.leagueStatsApp.renderContent();
    }
};
</script>
{% endblock %}